// peepdf comment: Javascript code located in object 10 (version 1)

/Artifact <</Attached [/Top ]/Type / Pagination / BBox[88.25 733.348 523.75 756.25] >> BDC / OC / MC0 BDC / CS0 cs 1 0 0 scn
1 i / GS0 gs
BT / TT0 1 Tf - 0.0008 Tc - 0.0002 Tw 0 Ts 100 Tz 0 Tr 16.02 0 0 16.02 204.6 736.6801 Tm(Company and Services) Tj
ET
88.5 753.78 435 2.22 re
f
EMC
EMC
q
289.14 81.36 33.72 - 30.72 re
W * n
q
29.5200043 0 0 29.5200043 291.5999756 51.8400421 cm / Im0 Do
Q / Artifact << >> BDC
Q
0 g
BT / TT0 1 Tf
0 Tc 0 Tw 12 0 0 12 322.86 50.58 Tm() Tj - 0.0009 Tc - 1.76 - 1.01 Td(4) Tj
ET
EMC / P << /MCID 0 >>BDC 
BT
/TT0
1 Tf
0.0001 Tw 13.02 0 0 13.02 90 706.92 Tm(Advanced Technologies) Tj
ET
EMC / P << /MCID 1 >>BDC 
BT
/TT1
1 Tf
0 Tc - 0.0016 Tw 12 0 0 12 90 689.1 Tm(BDP Advanced Technologies deliver hi) Tj
0.0006 Tc - 0.0022 Tw[(ghly techni) 5(cal and high inte) 6(grity)] TJ
0.0001 Tc - 0.0017 Tw 0 - 1.215 TD[(facilities
for the pharmaceuticals, life science, semiconduc) 6(tor, )] TJ
0.0003 Tc - 0.0003 Tw T * [(electronics, & food industries) 6(.)] TJ
ET
EMC / P << /MCID 2 >>BDC 
BT
/TT1
1 Tf
0 Tc 0 Tw 12 0 0 12 90 645.3 Tm() Tj
ET
EMC / P << /MCID 3 >>BDC 
BT
/TT1
1 Tf - 0.0001 Tc - 0.0015 Tw 12 0 0 12 90 630.72 Tm(Using in -house multidisciplinary te) Tj
0.0006 Tc - 0.0022 Tw 17.355 0 Td(ams and integrated methods, we) Tj - 0.0001 Tc - 0.0015 Tw - 17.355 - 1.215 Td[(provide ei) - 6(ther a complete design)] TJ - 0.0002 Tc - 0.0014 Tw 16.875 0 Td[(service or tota) - 5(l "turnkey"
project)] TJ
0.0002 Tc - 0.0018 Tw - 16.875 - 1.215 Td(delivery called Design Led Contracting\231.) Tj
ET
EMC / P << /MCID 4 >>BDC 
BT
/TT1
1 Tf
0 Tc 0 Tw 12 0 0 12 90 586.98 Tm() Tj
ET
EMC / P << /MCID 5 >>BDC 
BT
/TT1
1 Tf - 0.0016 Tw 12 0 0 12 90 572.4 Tm[(Projects range from state of the art ")-6(g)-2(reenfield"
facilities to)] TJ
0.0003 Tc - 0.0019 Tw T * (refurbishment and expansion) Tj - 0.0002 Tc - 0.0014 Tw 15.075 0 Td(of existing facilities.) Tj
ET
EMC / P << /MCID 6 >>BDC 
BT
/TT1
1 Tf
0 Tc 0 Tw 12 0 0 12 90 543.24 Tm() Tj
ET
EMC / P << /MCID 7 >>BDC 
BT
/TT1
1 Tf
0.0002 Tc - 0.0018 Tw 12 0 0 12 90 528.66 Tm(Our experienced and knowledgeable wo) Tj
0.0001 Tc - 0.0004 Tw 20.06 0 Td(rkforce is capable of delivering) Tj
0 Tc - 0.0016 Tw - 20.06 - 1.215 Td(world class buildings through: se) Tj
0.0001 Tc - 0.0001 Tw 16.59 0 Td[(ctor a) - 4(w) - 1(areness; strong client)] TJ - 0.0033 Tw - 16.59 - 1.215 Td(relationships; team building; exte) Tj
0.0008 Tc - 0.0024 Tw[(nsive benchma) 6(rking; and the latest)] TJ
0.0003 Tc - 0.0019 Tw T * (IT and CAD technology.) Tj
ET
EMC / P << /MCID 8 >>BDC 
BT
/TT1
1 Tf
0 Tc 0 Tw 12 0 0 12 90 470.34 Tm() Tj
ET
EMC / P << /MCID 9 >>BDC 
BT
/TT1
1 Tf - 0.0002 Tc - 0.0014 Tw 12 0 0 12 90 455.76 Tm[(We have offices) - 4( in England, Irelan)] TJ
0.0002 Tc - 0.0018 Tw 17.225 0 Td(d, Scotland and Singapore, with) Tj - 17.225 - 1.215 Td[(associations throug) 3(hout Europe and)] TJ
0 Tc - 0.0016 Tw 18.435 0 Td(Asia.Where possible we prefer to) Tj - 0.0006 Tc 0 Tw - 18.435 - 1.22 Td[(work dire) - 5(ctly on sit) - 7(e or co)] TJ
0.0004 Tc - 0.002 Tw 13.085 0 Td(-located with our clients.) Tj / TT2 1 Tf
0 Tc 0 Tw 12.5 0 Td() Tj
ET
EMC

// peepdf comment: Javascript code located in object 68 (version 1)

g_currentRenderMode = "solid";
g_animateGeometry = true
g_animateCamera = true
g_loopAnimation = true
g_flashLightOn = false
g_framesPerSecond = 10.000000
g_flashLightIntensity = 0.250000
/*--------------------------------------------------------------------------------------+
|
|    $RCSfile: pdfu3d.js,v $
|   $Revision: 1.1.2.13 $
|       $Date: 2005/01/29 22:51:54 $
|     $Author: RayBentley $
|
| Copyright (c) 1985-2001;  Bentley Systems, Inc., 685 Stockton Drive,
|                      Exton PA, 19341-0678, USA.  All Rights Reserved.
|
| This program is confidential, proprietary and unpublished property of Bentley Systems
| Inc. It may NOT be copied in part or in whole on any medium, either electronic or
| printed, without the express written consent of Bentley Systems, Inc.
|
+--------------------------------------------------------------------------------------*/
g_selectMode = "LevelMode"; // Select by level.

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
* Menu Items  IDs asnd Labels.
+---------------+---------------+---------------+---------------+---------------+------*/
g_sceneDisplayIds = new Array();
g_sceneDisplayLabels = new Array();

g_selectDisplayIds = new Array();
g_selectDisplayLabels = new Array();

g_selectModeIds = new Array();
g_selectModeLabels = new Array();

function pushNewSceneDisplay(id, label) {
    g_sceneDisplayIds.push(id);
    g_sceneDisplayLabels.push(label);
}

function pushNewSelectDisplay(id, label) {
    g_selectDisplayIds.push(id);
    g_selectDisplayLabels.push(label);
}

function pushNewSelectMode(id, label) {
    g_selectModeIds.push(id);
    g_selectModeLabels.push(label);
}

function addSeperator(id) {
    runtime.addCustomMenuItem(id, "_____________________________", "default", false)
};

pushNewSceneDisplay("Scene_solid", "Scene Shaded");
pushNewSceneDisplay("Scene_illustration", "Scene Illustration");
pushNewSceneDisplay("Scene_CAD illustration", "Scene Shaded Illustration");
pushNewSceneDisplay("Scene_transparent", "Scene Transparent");

pushNewSelectDisplay("Select_solid", "Select Shaded");
pushNewSelectDisplay("Select_illustration", "Select Illustration");
pushNewSelectDisplay("Select_CAD Illustration", "Select Shaded Illustration");
pushNewSelectDisplay("Select_transparent", "Select Transparent");

pushNewSelectMode("ElementMode", "Select Element");
pushNewSelectMode("LevelMode", "Select By Level");
pushNewSelectMode("MaterialMode", "Select By Material");
pushNewSelectMode("ModelMode", "Select By Model");

/*  Initial rendermode. */
for (i = 0; i < scene.meshes.count; i++)
scene.meshes.getByIndex(i).renderMode = g_currentRenderMode;

g_stopped = false;


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function setCameraMotion(enableCameraMotion) {
    g_animateCamera = enableCameraMotion;
} /*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function refreshScreen() {
    if (runtime.refresh != undefined) runtime.refresh();
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
* Animation Handler
+---------------+---------------+---------------+---------------+---------------+------*/
if (g_animateGeometry || g_animateCamera) {
    theCamera = scene.cameras.getByIndex(0);

    animation = scene.animations.getByIndex(0);
    animation.speed = 1;
    animation.oneFrame = 1 / animation.framesPerSecond;
    animation.forward = true;


    animation.init = function() {
        s_timeDelta = 1.0;
        s_speedRatio = 1.1;

        scene.activateAnimation(this);

        if (g_animateCamera) this.camera = scene.cameras.getByIndex(1);


        /*---------------------------------------------------------------------------------**/
/**
        * @bsimethod                                                    RayBentley      12/04
        +---------------+---------------+---------------+---------------+---------------+------*/
        function incrementFrame() {
            animation.currentTime += animation.oneFrame * animation.speed * s_timeDelta;
            if (animation.currentTime > animation.endTime) animation.currentTime = g_loopAnimation ? animation.startTime : animation.endTime;
        }

        /*---------------------------------------------------------------------------------**/
/**
        * @bsimethod                                                    RayBentley      12/04
        +---------------+---------------+---------------+---------------+---------------+------*/
        function decrementFrame() {
            animation.currentTime -= animation.oneFrame * animation.speed * s_timeDelta;

            if (animation.currentTime < animation.startTime) animation.currentTime = g_loopAnimation ? animation.endTime : animation.startTime;

        }

        /*---------------------------------------------------------------------------------**/
/**
        * @bsimethod    Timer                                           RayBentley      12/04
        +---------------+---------------+---------------+---------------+---------------+------*/
        this.timer = new TimeEventHandler();
        this.timer.owner = this;

        this.timer.onEvent = function(event) {
            if (!g_stopped) animation.forward ? incrementFrame() : decrementFrame();

            if (g_animateCamera) {
                theCamera.position.set(this.owner.camera.position);
                theCamera.targetPosition.set(this.owner.camera.targetPosition);
                theCamera.fov = this.owner.camera.fov;
                theCamera.projectionType = this.owner.camera.projectionType;
            }
        }
        runtime.addEventHandler(this.timer);

        /*---------------------------------------------------------------------------------**/
/**
        * @bsimethod    KeyEventHandler                                           RayBentley      12/04
        +---------------+---------------+---------------+---------------+---------------+------*/
        this.keyEventHandler = new KeyEventHandler()
        this.keyEventHandler.onEvent = function(event) {
            switch (event.characterCode) {
            case 1:
                // End
                animation.currentTime = animation.endTime;
                break;

            case 4:
                // Home.
                animation.currentTime = 0;
                break;

            case 8:
                // Backspace
                animation.forward = !animation.forward;
                break;

            case 27:
                // Escape.
                g_stopped = !g_stopped;
                break;

            case 28:
                if (g_stopped) decrementFrame();
                else s_timeDelta /= s_speedRatio;

                break;

            case 29:
                if (g_stopped) incrementFrame();
                else s_timeDelta *= s_speedRatio;

                break;
            }
        }
        runtime.addEventHandler(this.keyEventHandler);

    }
    animation.init();
}



/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
* Flashlight Handler
+---------------+---------------+---------------+---------------+---------------+------*/
flashLight = scene.createLight();
flashLight.brightness = (g_flashLightOn ? g_flashLightIntensity : 0.0);
flashLight.type = "infinite"

function synchFlashlight() {
    theCamera = scene.cameras.getByIndex(0);

    flashLight.direction.set(theCamera.targetPosition);
    flashLight.direction.subtractInPlace(theCamera.position);
    flashLight.direction.normalize();
}


flashlightRenderEventHandler = new RenderEventHandler()
flashlightRenderEventHandler.onEvent = function(event) {
    synchFlashlight();
}

flashlightMouseEventHandler = new MouseEventHandler();
flashlightMouseEventHandler.reportAllTargets = false;
flashlightMouseEventHandler.onMouseMove = true;

flashlightMouseEventHandler.onEvent = function(event) {
    synchFlashlight();
}

runtime.addEventHandler(flashlightMouseEventHandler);
runtime.addEventHandler(flashlightRenderEventHandler);


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
* Tools
+---------------+---------------+---------------+---------------+---------------+------*/
s_selectToolID = "select";
s_hideToolID = "hide";
s_showToolID = "show";
s_transparentToolID = "transparent";
s_isolateToolID = "isolate";

g_selected = new Array();
g_selectRenderMode = "transparent";
g_nodesHidden = false;

runtime.addCustomToolButton(s_selectToolID, "Select", "tool button");
runtime.addCustomToolButton(s_hideToolID, "Hide", "push button");
runtime.addCustomToolButton(s_showToolID, "Show", "push button");
runtime.addCustomToolButton(s_isolateToolID, "Isolate", "push button");

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function synchMenuItems() {
    if (g_selected.length > 0) {
        runtime.enableTool(s_hideToolID);
        runtime.enableTool(s_isolateToolID);
    } else {
        runtime.disableTool(s_hideToolID);
        runtime.disableTool(s_isolateToolID);
    }

    if (g_nodesHidden) runtime.enableTool(s_showToolID);
    else runtime.enableTool(s_showToolID);
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function findSelected(findObject) {
    for (i = 0; i < g_selected.length; i++)
    if (g_selected[i] == findObject) return i;

    return -1;
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function levelOrModelStringFromNodeName(name) {
    idIndex = name.lastIndexOf("#");
    if ("LevelMode" == g_selectMode) {
        if (-1 != idIndex) return name.substr(0, idIndex);
    } else {
        refIndex = name.indexOf("R");
        if (-1 != refIndex) return name.substring(refIndex, idIndex);
        else return "";
    }

    return null;
}


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function addSelected(addObject) {
    if ("ElementMode" == g_selectMode) {
        addObject.renderMode = g_selectRenderMode;
        g_selected.push(addObject);
    } else if ("MaterialMode" == g_selectMode) {
        materialToSelect = addObject.material.name;
        for (j = 0; j < scene.meshes.count; j++) {
            thisMesh = scene.meshes.getByIndex(j);
            if (null != thisMesh && null != thisMesh.material && thisMesh.material.name == materialToSelect) {
                thisMesh.renderMode = g_selectRenderMode;
                g_selected.push(thisMesh);
            }
        }
    } else {
        if (null != (stringToSelect = levelOrModelStringFromNodeName(addObject.name))) {
            for (j = 0; j < scene.meshes.count; j++) {
                thisMesh = scene.meshes.getByIndex(j);
                if (null != thisMesh && levelOrModelStringFromNodeName(thisMesh.name) == stringToSelect) {
                    thisMesh.renderMode = g_selectRenderMode;
                    g_selected.push(thisMesh);
                }
            }
        }
    }
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function dropSelected(dropIndex) {
    if ("ElementMode" == g_selectMode) {
        g_selected[dropIndex].renderMode = g_currentRenderMode;
        g_selected.splice(dropIndex, 1);
    } else if ("MaterialMode" == g_selectMode) {
        materialToSelect = g_selected[i].material.name;
        for (i = 0; i < g_selected.length;) {
            if (g_selected[i].materialName == materialToSelect) {
                g_selected[i].renderMode = g_currentRenderMode;
                g_selected.splice(i, 1);
            } else {
                i++;
            }
        }
    } else {
        if (null != (levelToSelect = levelOrModelStringFromNodeName(g_selected[i].name))) {
            for (i = 0; i < g_selected.length;) {
                if (levelOrModelStringFromNodeName(g_selected[i].name) == levelToSelect) {
                    g_selected[i].renderMode = g_currentRenderMode;
                    g_selected.splice(i, 1);
                } else {
                    i++;
                }
            }
        }
    }
}


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function emptySelection() {
    for (i = 0; i < g_selected.length; i++)
    g_selected[i].renderMode = g_currentRenderMode;

    while (0 != g_selected.length)
    g_selected.pop();
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function selectTool(mouseEvent) {
    if (!mouseEvent.shiftKeyDown) emptySelection()

    if (mouseEvent.hits.length > 0) {
        hitObject = mouseEvent.hits[0].target

        if (mouseEvent.shiftKeyDown) {
            if ((selectedIndex = findSelected(hitObject)) < 0) addSelected(hitObject);
            else dropSelected(selectedIndex);
        } else {
            addSelected(hitObject);
        }
    }
    synchMenuItems();
}


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function hideTool() {
    for (i = 0; i < g_selected.length; i++)
    g_selected[i].visible = false;

    emptySelection();
    refreshScreen();
    if (!g_nodesHidden) g_nodesHidden = true;

    synchMenuItems();
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function isolateTool() {
    for (i = 0; i < scene.meshes.count; i++)
    scene.meshes.getByIndex(i).visible = false;

    for (i = 0; i < g_selected.length; i++)
    g_selected[i].visible = true;

    refreshScreen();
    g_nodesHidden = true;
    synchMenuItems();
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function showAllTool() {
    if (g_nodesHidden) {
        for (i = 0; i < scene.meshes.count; i++)
        scene.meshes.getByIndex(i).visible = true;

        refreshScreen();
        g_nodesHidden = false;
    }
    synchMenuItems();
}



toolMouseEventHandler = new MouseEventHandler();
toolMouseEventHandler.reportAllTargets = false;
toolMouseEventHandler.onMouseMove = false;

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
toolMouseEventHandler.onEvent = function(event) {
    if (event.isMouseDown) {
        if (event.currentTool == s_selectToolID) selectTool(event);
    }
}

g_currentTool = "rotate";
toolEventHandler = new ToolEventHandler(); /*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
toolEventHandler.onEvent = function(event) {
    if (event.toolName == s_hideToolID) {
        hideTool();
        runtime.setCurrentTool(g_currentTool);
    } else if (event.toolName == s_showToolID) {
        showAllTool();
        runtime.setCurrentTool(g_currentTool);
    } else if (event.toolName == s_isolateToolID) {
        isolateTool();
        runtime.setCurrentTool(g_currentTool);
    } else {
        g_currentTool = event.toolName;
    }
}




runtime.addEventHandler(toolMouseEventHandler);
runtime.addEventHandler(toolEventHandler);

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function addMenuItems(toolIds, toolLabels, currentToolId) {
    for (i = 0; i < toolIds.length; i++)
    runtime.addCustomMenuItem(toolIds[i], (currentToolId == toolIds[i] ? "X" : " ") + " " + " " + toolLabels[i], "default", false);
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function clearMenuItems(toolIds) {
    i = 0;
    for (; i < toolIds.length; i++)
    runtime.removeCustomMenuItem(toolIds[i]);
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function addAllMenuItems() {
    addMenuItems(g_sceneDisplayIds, g_sceneDisplayLabels, "Scene_" + g_currentRenderMode);
    addSeperator("sep1");
    addMenuItems(g_selectDisplayIds, g_selectDisplayLabels, "Select_" + g_selectRenderMode);
    addSeperator("sep2");
    addMenuItems(g_selectModeIds, g_selectModeLabels, g_selectMode);
    addSeperator("sep3");
    runtime.addCustomMenuItem("flashlight", "Flashlight", "checked", g_flashLightOn); /*    runtime.addCustomMenuItem ("Animate */
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function clearAllMenuItems() {
    clearMenuItems(g_sceneDisplayIds);
    runtime.removeCustomMenuItem("sep1");
    clearMenuItems(g_selectDisplayIds);
    runtime.removeCustomMenuItem("sep2");
    clearMenuItems(g_selectModeIds);
    runtime.removeCustomMenuItem("sep3");
    runtime.removeCustomMenuItem("flashlight");
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function setSceneDisplayMode(displayMode) {
    g_currentRenderMode = displayMode;

    for (i = 0; i < scene.meshes.count; i++)
    scene.meshes.getByIndex(i).renderMode = g_currentRenderMode;

    for (i = 0; i < g_selected.length; i++)
    g_selected[i].renderMode = g_selectRenderMode;

    refreshScreen();
}


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function setSelectionDisplayMode(displayMode) {
    g_selectRenderMode = displayMode;
    for (i = 0; i < g_selected.length; i++)
    g_selected[i].renderMode = g_selectRenderMode;

    refreshScreen();
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      12/04
+---------------+---------------+---------------+---------------+---------------+------*/
function synchMenuItems() {
    clearAllMenuItems();
    addAllMenuItems();
}

addAllMenuItems();
myMenuEventHandler = new MenuEventHandler();

myMenuEventHandler.onEvent = function(event) {
    if (0 == event.menuItemName.indexOf("Scene")) {
        setSceneDisplayMode(event.menuItemName.substr(6));
        synchMenuItems();
    } else if (0 == event.menuItemName.indexOf("Select")) {
        setSelectionDisplayMode(event.menuItemName.substr(7));
        synchMenuItems();
    } else if (event.menuItemName == "flashlight") {
        g_flashLightOn = !g_flashLightOn;
        flashLight.brightness = (g_flashLightOn ? g_flashLightIntensity : 0.0);
        refreshScreen();
    } else {
        g_selectMode = event.menuItemName;
    }
}
runtime.addEventHandler(myMenuEventHandler);



/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function pauseAnimation() {
    g_stopped = true;
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function restartAnimation() {
    g_stopped = false;
}



/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function freezeAnimation(time) {
    animation.currentTime = time;
    g_stopped = true;
}

/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function freezeAnimationFrame(frameNumber) {
    animation.currentTime = frameNumber / g_framesPerSecond;
    g_stopped = true;
}


/*---------------------------------------------------------------------------------**/
/**
* @bsimethod                                                    RayBentley      11/04
+---------------+---------------+---------------+---------------+---------------+------*/
function reverseAnimation() {
    animation.forward = !animation.forward;
}


/*---------------------------------------------------------------------------------**/
/**
* User Supplied JavaScript.
* Refer to Adobe "3D in PDF - JavaScript API for details on using JavaScript to customize
* embedded 3D Annotations.
+---------------+---------------+---------------+---------------+---------------+------*/

